# build all
# g1不包含局部变量与行号有关的调试信息
# g2(默认)包括扩展的符号表、行号、局部或外部变量信息

ver = debug

ifeq ($(ver), debug)
CXX_ADDITION_FLAGS = -g3 -gdwarf-2 -static -static-libgcc -Wno-deprecated -DTIXML_USE_STL -DDEBUG
LINK_ADDITION_FLAGS = -rdynamic
else
CXX_ADDITION_FLAGS = -O3 -g1 -gdwarf-2 -static -static-libgcc -Wno-deprecated -DTIXML_USE_STL
LINK_ADDITION_FLAGS = -rdynamic
endif


OBJ_ROOT = ../tmp/
MAKE_FLAGS = --no-print-directory

all :
	@$(MAKE) -C zlib $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C pcre $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C tinyxml $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C jsoncpp $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C formula_cal $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C sdu $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C sdnet $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C collision $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C grid_world $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C box2d $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C navmesh $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C net_manager $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C transfer $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C commonlib $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
#	@$(MAKE) -C flashserver $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C gameholder $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C gameserver $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C gateserver $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C centerserver $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
#	@$(MAKE) -C timerserver $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
	@$(MAKE) -C server_info $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
#	@$(MAKE) -C robot $(MAKE_FLAGS) -e CXX_ADDITION_FLAGS="$(CXX_ADDITION_FLAGS)" LINK_ADDITION_FLAGS="$(LINK_ADDITION_FLAGS)" OBJ_ROOT="$(OBJ_ROOT)"
# clean all
clean :
	@make clean -C zlib $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C pcre $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C tinyxml $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C jsoncpp $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C formula_cal $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C sdu $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C sdnet $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C collision $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C grid_world $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C box2d $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C navmesh $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C net_manager $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C transfer $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C commonlib $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
#	@make clean -C flashserver $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C gameholder $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C gameserver $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C gateserver $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C centerserver $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
# 	@make clean -C timerserver $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C server_info $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
	@make clean -C robot $(MAKE_FLAGS) -e OBJ_ROOT="$(OBJ_ROOT)"
#help
help:
	@echo help
	
